%======================================================================
%   F R O N T  M A T T E R
%======================================================================
\pagestyle{empty}
\pagenumbering{roman}


% T I T L E   P A G E
% -------------------
\begin{titlepage}
    \begin{center}
        \vspace*{1.0cm}

        \Huge
        {\bf Design and Gait Synthesis for a \\ 3D Lower Body Humanoid}

        \vspace*{1.0cm}

        \normalsize
        by \\

        \vspace*{1.0cm}

        \Large
        Safwan Choudhury \\

        \vspace*{3.0cm}

        \normalsize
        A thesis \\
        presented to the University of Waterloo \\ 
        in fulfillment of the \\
        thesis requirement for the degree of \\
        Master of Applied Science \\
        in \\
        Electrical Engineering\\
 		Systems and Controls \\

        \vspace*{2.0cm}

        Waterloo, Ontario, Canada, 2012 \\

        \vspace*{1.0cm}

        \copyright\ Safwan Choudhury 2012 \\
    \end{center}
\end{titlepage}

\pagestyle{plain}
\setcounter{page}{2}

\cleardoublepage


% D E C L A R A T I O N
% ---------------------
\noindent
I hereby declare that I am the sole author of this thesis. This is a true copy of the thesis, including any required final revisions, as accepted by my examiners.

\bigskip
  
\noindent
I understand that my thesis may be made electronically available to the public.

\cleardoublepage
%\newpage


% A B S T R A C T
% ---------------
\begin{center}
    \textbf{Abstract}
\end{center}

Bipedal locomotion is a challenging control engineering problem due to its non-linear dynamics and postural instability of the bipedal form. In addition to these challenges, some dynamical effects such as the ground reaction force are difficult to model accurately in simulation. To this end, it is essential to develop physical hardware to validate walking control strategies and gait generation methods. This thesis develops an on-line walking control strategy for humanoid robots and the electromechanical design of a physical platform for experimental validation. 

The first part of the thesis presents the development of a 14 degrees-of-freedom (DOF) lower body humanoid robot. The initial electromechanical design of the proposed system is derived from dynamic modeling of a general multibody system. Kinematic trajectories for the lower body joints are extracted from motion captured human gait data to form the preliminary design specifications. The drivetrain components are selected by analyzing the mechanical power requirements, torque-speed profiles, efficiency and thermal characteristics of actuators. The supporting mechanical chassis and power transmission system are designed to raise the center-of-mass (to reduce the swinging inertia of each leg) while minimizing the overall weight of the system. 

Refinements to the design of a complex multibody robotic system like the biped is an iterative process. The mechanical model of the system is transferred from Computer-Aided-Design (CAD) software to a dynamic simulator for analysis and the design is revised to improve performance. This iterative approach is necessary as small changes in the mechanical model can have significant impact on the overall dynamics of the system and the resulting behaviour as well as implications for control design. A streamlined prototyping toolchain is developed in this thesis to extract the relevant kinematic/dynamic parameters of a mechanical system in CAD and automatically generate the equivalent system in a dynamic simulator. This toolchain is used to revise the electromechanical design and generate forward dynamics simulations. 

The second portion of this thesis develops a novel walking control strategy for on-line gait synthesis for 3D bipedal robots based on the Foot Placement Estimator (FPE) algorithm. This algorithm is used to determine the desired swing foot position on the ground to \emph{restore} balance for a 2D bipedal robot. The FPE algorithm is extended to the general 3D case by selecting a suitable plane in the desired direction of motion. Complete gait cycles are formed by combining a finite state machine with the 2D FPE solution along the selected plane. Gait initiation is accomplished by computing state-dependent task space trajectories on-line to produce a forward momentum along the selected plane. A whole-body motion control framework (Jacobian-based prioritized task space control scheme) tracks the task space trajectories and generates the appropriate joint level command for each state. The joint level commands are tracked by local high gain PD controllers. This framework produces the desired whole-body motion during each state while satisfying higher priority constriants. Gait termination is accomplished by controlling the swing foot position to track the FPE point on the ground along the selected plane. 

The proposed control strategy is verified in simulation and experiments. A parallel hardware-in-the-loop (HIL) testing environment is developed for the physical lower body humanoid robot. The motion control framework and joint dynamics used in the proposed walking control strategy are verified through HIL experiments.

\cleardoublepage
%\newpage


% A C K N O W L E D G E M E N T S
% -------------------------------
\begin{center}
    \textbf{Acknowledgements}
\end{center}

I would like to thank my supervisor Dana Kuli\'{c} for her invaluable guidance and support throughout my research. I'm extremely grateful for her advice, paper editing, debugging sessions and countless meetings over the last two years.  

I would also like to thank the following people for their assistance during the course of my masters research: 

\begin{itemize}
    \item Dr. Derek Wight for his advice on electromechanical design, developing models with QUARC and help with the HIL experiments. I am also grateful for the opportunity to work at Quanser Inc under the NSERC Industrial Postgraduate Scholarship. The experience was extremely valuable to the development of our streamlined toolchain during the design process. \\

    \item Christopher Kirby from Christie Digital Systems for taking the time to to provide guidance on the mechanical design. As an electrical engineering undergraduate with minimal experience and knowledge of mechanical engineering, his advice on best  practices, designing the mechanical power transmission system for the biped and generating CAD drawings was invaluable. \\

    \item Matt Millard of the Real Motion Group in Systems Design Engineering for his expertise in the field of gait analysis and for help with a wide range of topics pertaining to walking robots and contact modeling.  \\

    \item Charles Boyle at the Engineering Machine Shop on campus for his advice and assistance with manufacturing the bipedal robot. Charlie often stayed after hours and helped with machining various parts of the project.  \\

\end{itemize}

Finally, I would like to thank my family and my wife for providing their endless encouragement and support throughout my academic career at the University of Waterloo. 

\cleardoublepage
%\newpage


% D E D I C A T I O N
% -------------------
% \begin{center}
%     \textbf{Dedication}
% \end{center}

% This is dedicated to the one I love.
% \cleardoublepage
%\newpage


% T A B L E   O F   C O N T E N T S
% ---------------------------------
\renewcommand\contentsname{Table of Contents}
\addcontentsline{toc}{chapter}{Table of Contents}
\tableofcontents
\cleardoublepage
\phantomsection
%\newpage


% L I S T   O F   T A B L E S
% ---------------------------
\addcontentsline{toc}{chapter}{List of Tables}
\listoftables
\cleardoublepage
\phantomsection		% allows hyperref to link to the correct page
%\newpage


% L I S T   O F   F I G U R E S
% -----------------------------
\addcontentsline{toc}{chapter}{List of Figures}
\listoffigures
\cleardoublepage
\phantomsection		% allows hyperref to link to the correct page
%\newpage


% L I S T   O F   S Y M B O L S
% -----------------------------
% To include a Nomenclature section
% \addcontentsline{toc}{chapter}{\textbf{Nomenclature}}
% \renewcommand{\nomname}{Nomenclature}
% \printglossary
% \cleardoublepage
% \phantomsection % allows hyperref to link to the correct page
% \newpage

\pagenumbering{arabic} % Change page numbering back to Arabic numerals

